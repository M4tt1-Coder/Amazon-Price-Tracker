{% extends "base.html" %}
{% load static %}
{% block title %}
    Manage Products
{% endblock title %}
{% block content %}
    {% block scripts %}
        <script>
  function CopyText(clicked_id) {
  var text = document.getElementById(clicked_id);
  var title = text.getAttribute("title");
  var tempInput = document.createElement("input");
        tempInput.value = title;
        document.body.appendChild(tempInput);
        tempInput.select();
  document.execCommand('copy')}


  function attention(){
      if(!confirm("Are you sure, that you want to delete this url? This will delete the data too!")){event.preventDefault()}

}

        </script>
    {% endblock scripts %}
    <div class="w-full bg-gray-200 rounded-lg">
        <h1 class="text-center font-bold text-2xl hover:scale-110 hover:font-semibold transition-all duration-500">
            Here you can add a Product to you tracker
        </h1>
        <div class="container mx-auto px-4 py-5">
            <div class="w-full flex items-center justify-center gap-4">
                <form action="{% url 'create' %}" method="post">
                    {% csrf_token %}
                    {{ form }}
                    <input type="submit"
                           name="submit"
                           value="submit"
                           class="p-2 bg-black text-xl font-medium text-white rounded-xl transition-all duration-500 hover:bg-white hover:text-black hover:scale-105 hover:ring-2 hover:ring-black">
                    <input type="submit"
                           name="submit"
                           value="delete"
                           onClick="attention()"
                           class="p-2 bg-black text-xl font-medium text-white rounded-xl transition-all duration-500 hover:bg-white hover:text-black hover:scale-105 hover:ring-2 hover:ring-black">
                </form>
            </div>
        </div>
        {% if flag %}
            <div class="fixed z-40 w-screen h-screen inset-0 bg-gray-900 bg-opacity-60 border-2 border-black rounded-lg">
                <h>Error:</h>
                <p>You currently can only submit URLs from: https://fakestoreapi.com/</p>
                <form action="{% url 'create' %}" method="post">
                    {% csrf_token %}
                    <button type="submit"
                            name="go_back"
                            class="backdrop-blur-2xl bg-black text-white hover:bg-white hover:text-black hover:scale-105 hover:ring-2 hover:ring-black">
                        go back
                    </button>
                </form>
            </div>
        {% endif %}
        <div class="display w-full rounded">
            <p class="text-black text-center font-bold text-2xl hover:scale-110 hover:font-semibold transition-all duration-500">
                Your Product URLs (click to copy links):
            </p>
            {% for item in products %}
                <li>
                    <span type="button"
                          contenteditable="true"
                          title="{{ item }}"
                          id="span"
                          class="w-auto align-center">
                        <input type="text"
                               title="{{ item.url }}"
                               value="{{ item.product }}"
                               id="{{ item.product }}"
                               class="w-full"
                               onclick="CopyText(id)">
                    </span>
                </li>
            {% endfor %}
        </div>
    </div>
{% endblock content %}
